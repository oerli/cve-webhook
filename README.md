# cve-webhook
This scripts informs you via a Webhook (eg. Microsoft Teams) if there is a new Vulnerability in the vulniq.com Database, for products or vendors you have specified.

## Run as Scheduled Task
This program should run as cron job/scheduled task. For now the Path are fixed, you would need to specify the run path where the templates and cfg folders located. As well messagecard.json.tera is a fixed path.

### Parameter
Parameter --webhook and --applications can be used to specify other than default path for yaml config (optional)
Parameter --ignore accepts a yaml list of CVE numbers to be ignored, this list will automatically be updated with new sent CVE numbers (optional)
```yaml
---
- CVE-2021-35054
- CVE-2021-34514
```
Parameter --minimum_score ignores any score below specified (default=0/none will be ignored)

## Example configuration
In the ./cfg folder specify the applications.yaml file which contains the product and vendor id's from cvedetails.com. The name can be a descriptive text/title for each id, the title is not used for lookups:
```yaml
- name: "VMWare Horizon"
  vendor: "vmware"
  product: "horizon"
- name: "VMWare Horizon Client"
  vendor: "vmware"
  product: "horizon_client"
```

In the webhook.yaml configuration is the url for the Webhook URL and the days attribute is to specify how often the cron job/schduled task should run, or it defines how many days back it should check for updated CVE's. The published parameter will ignore all CVE which have been created (published date) before the specified days. The template defines the main template file to use inside the templates folder:
```yaml
url: "https://xxx.webhook.office.com/webhookb2/xxx"
days: 1
published: 90
template: messagecard.json.tera
vulniq_baerer_token: "XXX"
```
Create the bearer token with your account at vulniq.com